data:
  type: "nyuv2"
  dataset_path: "../mtl_dataset/nyuv2"
  batch_size: 16
  num_workers: 4
  img_size: [288, 384]
  augmentation: True

model:
  type: "causal"
  encoder_name: "resnet50"
  pretrained: True
  # [修改点 1] 维度平衡：削减 Zs 防止其“偷懒”，扩大 Zp 给纹理留足空间
  latent_dim_s: 512    # 原 1024 -> 降为 512
  latent_dim_p: 256    # 原 64 -> 增为 256 (关键！)
  z_s_bottleneck_noise: 0.1

  # 物理分解头配置
  decomposition:
    enabled: true
    normal_head_hidden: 128
    albedo_head_hidden: 128
    light_head:
      sh_degree: 2
      # [修改点 2] 解除灰度封印：室内光照(NYUv2)通常是暖色，强制灰度会导致 Zp 颜色坍塌
      grayscale_prior: false  # 原 true -> 改为 false

training:
  seed: 2024
  epochs: 100
  optimizer: "AdamW"
  learning_rate: 0.0002
  weight_decay: 0.0001

  # === 时间表控制 ===
  stage0_epochs: 5
  stage1_epochs: 0
  ind_warmup_epochs: 10

  lr_scheduler:
    type: "cosine"
    warmup_epochs: 5
    min_lr_factor: 0.01

  cfa:
    enabled: true
    # [修改点 3] 激活 CFA：原 500 导致永远不运行，改为 20 让其尽早介入强迫解耦
    start_epoch: 20    # 原 500 -> 改为 20 (Stage 0 预热后尽快开启)
    cka_threshold: 0.1
    prob: 0.5
    lambda_cfa: 1.0
    mix_strategy: "global"

losses:
  # === 1. 核心任务 Loss ===
  lambda_seg: 20.0
  lambda_depth: 10.0
  lambda_normal: 10.0
  lambda_edge_consistency: 0.1

  # === 2. 独立性约束 ===
  lambda_independence: 1.0

  # === 3. 重构 Loss (Reconstruction) ===
  # 几何重构
  alpha_recon_geom: 2.0

  # [修改点 4] 重罚样式错误：原 2.0 太低，导致模型“躺平”。加倍惩罚迫使 Zp 学习纹理
  beta_recon_app: 15.0   # 原 2.0 -> 暴增为 15.0 (与 Seg Loss 量级抗衡)
  lambda_l1_recon: 2.0   # 原 1.0 -> 增为 2.0 (辅助提升像素级还原)

  # === 4. 物理分解与先验 ===
  lambda_img: 2.0
  lambda_alb_tv: 0.1
  # [修改点 5] 降低灰度惩罚：配合 grayscale_prior: false
  lambda_sh_gray: 0.001  # 原 0.1 -> 降为 0.001 (只保留极微弱的约束)
  lambda_xcov: 0.5